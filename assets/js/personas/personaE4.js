function recargar(){window.location.href=base_url+"personas/persona"}$(function(){redirectBrowser(),$(window).scroll(function(){$(this).scrollTop()>400?$(".scrollup").fadeIn():$(".scrollup").fadeOut()}),$(".scrollup").on("click",function(){return $("html, body").animate({scrollTop:0},600),!1}),$('[data-tooltip!=""]').qtip({content:{attr:"data-tooltip"},position:{my:"top left"},style:{classes:"qtip-bootstrap qtip-DANE"}});new BootstrapDialog({title:"Instancia del dialogo",message:"Mensaje generico"});$("#depto_nacimiento").cargarCombo("depto_nacimiento","muni_nacimiento",base_url+"formulario/listaDesplegable"),$("#depto_nacimiento").change(function(){$("option","#muni_nacimiento").remove()}),$("#muni_nacimiento").select2({allowClear:!0,language:"es",placeholder:"Municipio o área no municipalizada",theme:"bootstrap",width:"100%"}),$("input[type=radio][name=lugar_nacimiento]").on("change",function(){2==$(this).val()?($("#lugar_nacimiento-2-panel").removeClass("hidden"),$("#lugar_nacimiento-3-panel").addClass("hidden"),$("#pais_nacimiento").val(""),$("#anio_llego").val(""),$("#anio_llego-col").addClass("hidden")):3==$(this).val()?($("#lugar_nacimiento-3-panel").removeClass("hidden"),$("#lugar_nacimiento-2-panel").addClass("hidden"),$("#depto_nacimiento").val(""),$("#muni_nacimiento").val(""),$("#muni_nacimiento").select2({allowClear:!0,language:"es",placeholder:"Municipio o área no municipalizada",theme:"bootstrap",width:"100%"}),$("#anio_llego-col").removeClass("hidden")):($("#lugar_nacimiento-2-panel").addClass("hidden"),$("#depto_nacimiento").val(""),$("#muni_nacimiento").val(""),$("#muni_nacimiento").select2({allowClear:!0,language:"es",placeholder:"Municipio o área no municipalizada",theme:"bootstrap",width:"100%"}),$("#lugar_nacimiento-3-panel").addClass("hidden"),$("#pais_nacimiento").val(""),$("#anio_llego").val(""),$("#anio_llego-col").addClass("hidden"))}),$("input[type=radio][name=otra_lengua]").on("change",function(){1==$(this).val()?$("#cual_lengua-col").removeClass("hidden"):2==$(this).val()&&($("#cual_lengua-col").addClass("hidden"),$("#cual_lengua").val(""))}),$("#frmPersona").validate({errorClass:"error-form",rules:{lugar_nacimiento:{required:!0},depto_nacimiento:{selectVacio:!0,required:function(e){return 3==$("input[type=radio][name=lugar_nacimiento]:checked").val()}},muni_nacimiento:{selectVacio:!0,required:function(e){return 3==$("input[type=radio][name=lugar_nacimiento]:checked").val()}},pais_nacimiento:{selectVacio:!0},anio_llego:{selectVacio:!0}},messages:{lugar_nacimiento:{required:"ERROR: Debe seleccionar donde nació la persona."},depto_nacimiento:{selectVacio:"ERROR: Debe seleccionar el departamento de nacimiento de la persona.",required:"ERROR: Debe seleccionar el departamento de nacimiento de la persona."},muni_nacimiento:{selectVacio:"ERROR: Debe seleccionar el municipio de nacimiento de la persona.",required:"ERROR: Debe seleccionar el municipio de nacimiento de la persona."},pais_nacimiento:{selectVacio:"ERROR: Debe seleccionar el país de nacimiento de la persona."},anio_llego:{selectVacio:"ERROR: Debe seleccionar el año en que año llegó a Colombia."}},onfocusout:function(e){$(e).valid()||$("#"+$(e).attr("id")).focus()},errorPlacement:function(e,a){$(a).parents(".form-group").first().append(e.attr("role","alert"))},highlight:function(e,a,n){$(e).parents(".form-group").first().addClass("has-error")},unhighlight:function(e,a,n){$(e).parents(".form-group").first().removeClass("has-error")},submitHandler:function(e){return!0}}),$("#btnSiguiente").on("click",function(){if(null==$("#muni_nacimiento").val())recargar();else if($(".alert").addClass("hidden"),1==$("#frmPersona").valid()){var e=$("#frmPersona").serialize();$(":input").addClass("disabled").prop("disabled",!0),$(":button").addClass("disabled").prop("disabled",!0),$.ajax({url:base_url+"personas/persona/guardar",type:"POST",dataType:"json",data:e+"&numePers="+$("#frmPersona").data("nume_pers")+"&duracion="+duracionPagina(),beforeSend:function(){$("#msgSuccess").html("Guardando la(s) respuesta(s). Espere por favor..."),$("#divMsg").removeClass("hidden"),$("#divMsgSuccess").removeClass("hidden")}}).done(function(e){0==e.codiError?($("#msgSuccess").html(e.mensaje),$("#divMsg").removeClass("hidden"),$("#divMsgSuccess").removeClass("hidden"),$("#progressbar").html(e.avance+" COMPLETADO").css("width",e.avance),setTimeout(recargar,2e3)):($("#msgError").html(e.mensaje),$("#divMsg").removeClass("hidden"),$("#divMsgAlert").removeClass("hidden"))}).fail(function(e){window.location.href=base_url+"persona"})}}),$("#btnAnterior").on("click",function(){$(":input").addClass("disabled").prop("disabled",!0),$(":button").addClass("disabled").prop("disabled",!0),$.ajax({url:base_url+"personas/persona/regresar",type:"POST",dataType:"json",data:"duracion="+duracionPagina()}).done(function(e){0==e.codiError?($("#progressbar").html(e.avance+" COMPLETADO").css("width",e.avance),window.location.href=base_url+"personas/persona"):($("#msgError").html(e.mensaje),$("#divMsg").removeClass("hidden"),$("#divMsgAlert").removeClass("hidden"))}).fail(function(e){window.location.href=base_url+"persona"})})});