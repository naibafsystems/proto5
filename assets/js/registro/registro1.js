function recargar(){window.location.href=base_url+"registro"}$(function(){redirectBrowser(),$(window).scroll(function(){$(this).scrollTop()>400?$(".scrollup").fadeIn():$(".scrollup").fadeOut()}),$(".scrollup").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$('[data-tooltip!=""]').qtip({content:{attr:"data-tooltip"},position:{my:"top left"},style:{classes:"qtip-bootstrap qtip-DANE"}});var e=new BootstrapDialog({title:"Instancia del dialogo",message:"Mensaje generico"});$("#fecha_expe-lbl").qtip({content:'<img src="'+base_url+'assets/images/cedula.jpg" alt="Owl" />',position:{my:"top right"},style:{classes:"qtip-bootstrap qtip-DANE"}});var a=function(a,o){$("#"+o+"-error").remove();var t=$("#"+a).val(),n=$("#"+o).val();return 0==t.length||"-"==t?($(this).val("").focus(),!1):0==n.length?($(this).val("").focus(),!1):void $.ajax({type:"POST",url:base_url+"registro/completarPersona",data:{tipoDocu:t,numeDocu:n,peticion:"1"},dataType:"json",cache:!1,beforeSend:function(){$("#animationload").fadeIn()},complete:function(){$("#animationload").fadeOut()},success:function(e){return 0!=e.codiError?($("#"+o).parents(".form-group").append('<label id="'+o+'-error" class="error-form"></label>'),e.msgError.length>0&&($("#"+o+"-error").html(e.msgError).attr("style",""),$("#"+o).val("")),!1):0==e.registraduria||void 0},error:function(a,o,t){return"timeout"==o||(e.setTitle("Validar número de documento"),e.setType(BootstrapDialog.TYPE_DANGER),e.setMessage(a.responseText),e.open(),!1)},timeout:1e4})},o=function(e,a){switch(e){case"1":if(a.length<11&&a.length>1)return!0;break;case"2":if(a.length<13&&a.length>1)return!0;break;case"3":if(a.length<11&&a.length>1)return!0;break;case"4":if(a.length<11&&a.length>2){var o=/[a-zA-Z0-9]/;if(a.match(o))return!0}}return!1};$.validator.addMethod("validaRC",function(e,a,t){var n=$("#"+t[0]).val(),i=$("#"+t[1]).val();return(6!=n||0!=i.length)&&("1"!=i||0!=e.length&&o(i,e))}),$.validator.addMethod("validaTI",function(e,a,t){var n=$("#"+t[0]).val(),i=$("#"+t[1]).val();return(6!=n||0!=i.length)&&("2"!=i||0!=e.length&&o(i,e))}),$.validator.addMethod("validaCC",function(e,a,t){var n=$("#"+t[0]).val();return 0!=n.length&&("3"!=n||0!=e.length&&o(n,e))}),$.validator.addMethod("validaCE",function(e,a,t){var n=$("#"+t[0]).val();return 0!=n.length&&("4"!=n||0!=e.length&&o(n,e))}),$.validator.addMethod("validaNN",function(e,a,o){var t=$("#"+o[0]).val(),n=$("#"+o[1]).val();return 6!=t||0!=n.length}),$.validator.addMethod("validarCamposFecha",function(e,a,o){if(3==$("#"+o[0]).val()){if(0==e.length||"-"==e)return!1;if(isNaN(e))return!1}return!0}),$.validator.addMethod("validarFechaExpe",function(e,a,o){var t=$("#"+o[0]),n=$("#"+o[1]),i=$("#"+o[2]),r=$("#"+o[3]);if(3==t.val()&&n.val().length>0&&i.val().length>0&&r.val().length>0){if(0==moment(n.val()+"-"+i.val()+"-"+r.val()).isValid())return!1}return!0}),$("#tipo_documento").on("change",function(){$("#numero_documento").val(""),$("#tipo_documento option:selected").each(function(){6==$(this).val()?($("#fecha_expe-col").addClass("hidden"),BootstrapDialog.show({title:"Mensaje de Notificación",closable:!1,type:BootstrapDialog.TYPE_WARNING,message:"Para crear una cuenta en el eCenso es necesario ser mayor de edad y tener cédula de ciudadanía o de extranjería. Su documento no figura en la base de datos de la Registraduría Nacional; por favor verifique la información e intente nuevamente.",buttons:[{label:"Aceptar",action:function(e){$(location).attr("href",base_url+"/registro")}}]})):($("#tipo_documento2-col").addClass("hidden"),$("#tipo_documento2").val(""),3==$(this).val()?$("#fecha_expe-col").removeClass("hidden"):($("#fecha_expe-col").addClass("hidden"),$("#anio_expe").val(""),$("#mes_expe").val(""),$("#dia_expe").val("")))})}),$("#tipo_documento2").on("change",function(){5==$(this).val()?$("#numero_documento-col").addClass("hidden"):$("#numero_documento-col").removeClass("hidden"),$("#numero_documento").val("")}),$("#numero_documento").on("keypress",function(e){var a=$("#tipo_documento").val();return 0==a.length||"-"==a?$(this).val("").focus():6==a&&(a=$("#tipo_documento2").val()),3==a?8==e.which||0==e.which||e.which>=48&&e.which<=57:4==a||2==a||1==a?0==e.which||8==e.which||13==e.which||(e.which>=48&&e.which<=57||(e.which>=65&&e.which<=90||e.which>=97&&e.which<=122)):void 0}),$("#numero_documento").on("blur",function(){var e=$("#tipo_documento").val(),t=$("#tipo_documento2").val();if(6!=e||6==e&&5!=t){var n=$("#numero_documento").val();if(o(e,n))return a("tipo_documento","numero_documento")}return!1}),$("#frmRegistro").validate({errorClass:"error-form",rules:{tipo_documento:{selectVacio:!0},tipo_documento2:{selectVacio:!0},numero_documento:{validaRC:["tipo_documento","tipo_documento2"],validaTI:["tipo_documento","tipo_documento2"],validaCC:["tipo_documento"],validaCE:["tipo_documento"]},anio_expe:{validarCamposFecha:["tipo_documento"],validarFechaExpe:["tipo_documento","anio_expe","mes_expe","dia_expe"]},mes_expe:{validarCamposFecha:["tipo_documento"],validarFechaExpe:["tipo_documento","anio_expe","mes_expe","dia_expe"]},dia_expe:{validarCamposFecha:["tipo_documento"],validarFechaExpe:["tipo_documento","anio_expe","mes_expe","dia_expe"]}},messages:{tipo_documento:{selectVacio:"ERROR: Seleccione el tipo de identificación de la persona."},tipo_documento2:{selectVacio:"ERROR: Seleccione el tipo 2 de identificación de la persona."},numero_documento:{validaRC:"ERROR: La longitud del número de documento debe serRC ser entre 2 a 10 caracteres.",validaTI:"ERROR: La longitud del número de documento debe serTI ser entre 2 a 12 caracteres.",validaCC:"ERROR: La longitud del número de documento debe ser entre 2 a 10 caracteres.",validaCE:"ERROR: El documento debe tener entre 2 a 10 dígitos y/o caracteres."},anio_expe:{validarCamposFecha:"ERROR: Seleccione el año de la fecha de expedición.",validarFechaExpe:"ERROR: La fecha de expedición definida no es válida."},mes_expe:{validarCamposFecha:"ERROR: Seleccione el mes de la fecha de expedición.",validarFechaExpe:"ERROR: La fecha de expedición definida no es válida."},dia_expe:{validarCamposFecha:"ERROR: Seleccione el día de la fecha de expedición.",validarFechaExpe:"ERROR: La fecha de expedición definida no es válida."}},onfocusout:function(e){$(e).valid()||$("#"+$(e).attr("id")).focus()},errorPlacement:function(e,a){a.parents(".input-group").hasClass("input-group")?a.parents(".input-group").parent().append(e):$(a).parents(".form-group").first().append(e.attr("role","alert"))},highlight:function(e,a,o){$(e).parents(".input-group").hasClass("input-group")||$(e).parent(".control-option").addClass("has-error")},unhighlight:function(e,a,o){$(e).parents(".input-group").hasClass("input-group")&&"anioExpe"==$(e).attr("id")?$(e).parents(".input-group").parent().removeClass("has-error errorForm"):$(e).parents(".control-option").removeClass("has-error")},submitHandler:function(e){return!0}}),$("#btnSiguiente").on("click",function(){if(1==$("#frmRegistro").valid()){var e=($("#frmRegistro").validate(),$("#tipo_documento").val(),$("#tipo_documento2").val(),$("#frmRegistro").serializeArray());$.each(e,function(e,a){$("#"+a.name+"-confirm").length>0&&($("#"+a.name).is("select")?($("#"+a.name+"-confirm").html($("#"+a.name+' option[value="'+a.value+'"]').html()),"tipo_documento"==a.name&&6==a.value&&$("#"+a.name+"-confirm").html(""),"tipo_documento2"==a.name&&6!=a.value&&$("#"+a.name+"-confirm").html("")):$("#"+a.name+"-confirm").html(a.value))}),$("#frmRegistro").addClass("hidden"),$("#mensajeConfirmacion").removeClass("hidden")}}),$("#btnAnteriorConfirmacion").on("click",function(){$("#frmRegistro").removeClass("hidden"),$("#mensajeConfirmacion").addClass("hidden")}),$("#btnSiguienteConfirmacion").on("click",function(){if(1==$("#frmRegistro").valid()){var a=$("#frmRegistro").serialize();$(":input").addClass("disabled").prop("disabled",!0),$(":button").addClass("disabled").prop("disabled",!0),$.ajax({url:base_url+"registro/guardar",type:"POST",dataType:"json",data:a+"&duracion="+duracionPagina(),beforeSend:function(){$("#msgSuccess").html("Guardando las respuestas..."),$("#divMsg").removeClass("hidden"),$("#divMsgSuccess").removeClass("hidden")}}).done(function(a){0==a.codiError?($("#msgSuccess").html(a.mensaje),$("#divMsg").removeClass("hidden"),$("#divMsgSuccess").removeClass("hidden"),$("#progressbar").html(a.avance+" COMPLETADO").css("width",a.avance),setTimeout(recargar,2e3)):(e.setTitle("Guardar cuenta"),e.setMessage(a.mensaje),e.open())}).fail(function(a){e.setTitle("Error al guardar"),e.setType(BootstrapDialog.TYPE_DANGER),e.setMessage(a.responseText),e.open()})}})});